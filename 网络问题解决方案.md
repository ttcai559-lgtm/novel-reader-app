# 🌐 网络连接问题解决方案

## ❌ 当前问题

测试时出现错误：
```
Cannot connect to host api.msedgeservices.com:443
```

**原因**: Edge TTS需要连接到微软服务器，但网络无法访问

---

## ✅ 解决方案

### 方案1: 配置代理（如果你有VPN/代理）⭐

#### Windows PowerShell:
```powershell
# 设置代理（替换成你的代理地址和端口）
$env:HTTP_PROXY="http://127.0.0.1:7890"
$env:HTTPS_PROXY="http://127.0.0.1:7890"

# 然后运行测试
cd D:\Python_file\APP_Tool
python simple_test.py
```

#### 命令提示符(CMD):
```cmd
set HTTP_PROXY=http://127.0.0.1:7890
set HTTPS_PROXY=http://127.0.0.1:7890

cd D:\Python_file\APP_Tool
python simple_test.py
```

**常见代理端口**:
- Clash: 7890
- V2Ray: 10808
- SSR: 1080

---

### 方案2: 使用本地TTS引擎（不需要网络）

我可以帮你切换到 `pyttsx3`（Windows本地TTS），优点：
- ✅ 完全离线
- ✅ 不需要网络
- ❌ 声音质量较差（机械音）

**安装和测试**:
```powershell
pip install pyttsx3
python local_tts_test.py  # 我会创建这个文件
```

---

### 方案3: 使用其他云端TTS（需要API密钥）

可以切换到：
- 百度AI语音合成（免费额度）
- 阿里云TTS（免费额度）
- 腾讯云TTS（免费额度）

需要：
1. 注册账号
2. 获取API密钥
3. 配置到项目中

---

### 方案4: 检查防火墙/DNS

#### 检查DNS:
```powershell
nslookup api.msedgeservices.com
```

如果解析失败，更换DNS:
```
首选DNS: 8.8.8.8 (Google)
备用DNS: 114.114.114.114 (国内)
```

#### 临时关闭防火墙测试:
```
控制面板 → 系统和安全 → Windows Defender 防火墙 → 关闭（测试后记得打开）
```

---

## 🎯 推荐步骤

### 第1步: 如果你有VPN/代理
1. 启动你的VPN或代理软件
2. 查看代理端口（通常在设置中）
3. 设置环境变量后重试

### 第2步: 如果没有VPN
**选项A**: 使用本地TTS（我帮你配置）
**选项B**: 注册云端TTS服务（百度/阿里云）
**选项C**: 暂时跳过，直接打包Android APK（手机上可能网络正常）

---

## 📞 告诉我你的情况

**情况1**: 我有VPN/代理
→ 告诉我代理端口，我给你具体命令

**情况2**: 我没有VPN，想用本地TTS
→ 我帮你配置pyttsx3（离线使用）

**情况3**: 我想注册云端TTS
→ 我指导你注册和配置

**情况4**: 我想直接打包Android APK
→ 手机上可能网络正常，可以跳过电脑测试

---

## 💡 临时测试方案

让我创建一个本地TTS测试，不需要网络：
